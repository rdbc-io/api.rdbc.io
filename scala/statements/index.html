



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="Krzysztof Pado">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>Statements - rdbc documentation - 0.0.82</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="green" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#statement-types" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="rdbc documentation - 0.0.82" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                rdbc documentation - 0.0.82
              </span>
              <span class="md-header-nav__topic">
                Statements
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/rdbc-io/rdbc/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      rdbc-io/rdbc
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    rdbc documentation - 0.0.82
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/rdbc-io/rdbc/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      rdbc-io/rdbc
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Scala API user guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Scala API user guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gettingstarted/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_concepts/" title="Core concepts" class="md-nav__link">
      Core concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connection/" title="Working with a connection" class="md-nav__link">
      Working with a connection
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Statements
      </label>
    
    <a href="./" title="Statements" class="md-nav__link md-nav__link--active">
      Statements
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#statement-types" title="Statement types" class="md-nav__link">
    Statement types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syntax" title="Syntax" class="md-nav__link">
    Syntax
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#named-parameters" title="Named parameters" class="md-nav__link">
    Named parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#positional-parameters" title="Positional parameters" class="md-nav__link">
    Positional parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-statements" title="Creating statements" class="md-nav__link">
    Creating statements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bare-strings" title="Bare strings" class="md-nav__link">
    Bare strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-interpolator" title="String interpolator" class="md-nav__link">
    String interpolator
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-sql" title="Dynamic SQL" class="md-nav__link">
    Dynamic SQL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options" title="Options" class="md-nav__link">
    Options
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#executing-statements" title="Executing statements" class="md-nav__link">
    Executing statements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executing-for-a-result-set" title="Executing for a result set" class="md-nav__link">
    Executing for a result set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streaming-results" title="Streaming results" class="md-nav__link">
    Streaming results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-ignoring-results" title="Executing ignoring results" class="md-nav__link">
    Executing ignoring results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-for-a-single-row-and-for-a-value" title="Executing for a single row and for a value" class="md-nav__link">
    Executing for a single row and for a value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-for-rows-affected" title="Executing for rows affected" class="md-nav__link">
    Executing for rows affected
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-for-generated-key" title="Executing for generated key" class="md-nav__link">
    Executing for generated key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streaming-statement-arguments" title="Streaming statement arguments" class="md-nav__link">
    Streaming statement arguments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#positional-and-named-parameters" title="Positional and named parameters" class="md-nav__link">
    Positional and named parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-failures" title="Handling failures" class="md-nav__link">
    Handling failures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" title="Examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../types/" title="Data types" class="md-nav__link">
      Data types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rows/" title="Result Rows" class="md-nav__link">
      Result Rows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../java/java/" title="Java API user guide" class="md-nav__link">
      Java API user guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../drivers/" title="Drivers" class="md-nav__link">
      Drivers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../privacy/" title="Privacy policy" class="md-nav__link">
      Privacy policy
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#statement-types" title="Statement types" class="md-nav__link">
    Statement types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syntax" title="Syntax" class="md-nav__link">
    Syntax
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#named-parameters" title="Named parameters" class="md-nav__link">
    Named parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#positional-parameters" title="Positional parameters" class="md-nav__link">
    Positional parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-statements" title="Creating statements" class="md-nav__link">
    Creating statements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bare-strings" title="Bare strings" class="md-nav__link">
    Bare strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-interpolator" title="String interpolator" class="md-nav__link">
    String interpolator
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-sql" title="Dynamic SQL" class="md-nav__link">
    Dynamic SQL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options" title="Options" class="md-nav__link">
    Options
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#executing-statements" title="Executing statements" class="md-nav__link">
    Executing statements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executing-for-a-result-set" title="Executing for a result set" class="md-nav__link">
    Executing for a result set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streaming-results" title="Streaming results" class="md-nav__link">
    Streaming results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-ignoring-results" title="Executing ignoring results" class="md-nav__link">
    Executing ignoring results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-for-a-single-row-and-for-a-value" title="Executing for a single row and for a value" class="md-nav__link">
    Executing for a single row and for a value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-for-rows-affected" title="Executing for rows affected" class="md-nav__link">
    Executing for rows affected
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-for-generated-key" title="Executing for generated key" class="md-nav__link">
    Executing for generated key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streaming-statement-arguments" title="Streaming statement arguments" class="md-nav__link">
    Streaming statement arguments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#positional-and-named-parameters" title="Positional and named parameters" class="md-nav__link">
    Positional and named parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-failures" title="Handling failures" class="md-nav__link">
    Handling failures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" title="Examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/rdbc-io/rdbc/blob/master/rdbc-doc/docs/scala/statements.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Statements</h1>
                
                <!---
 ! Copyright 2016-2017 rdbc contributors
 !
 ! Licensed under the Apache License, Version 2.0 (the "License");
 ! you may not use this file except in compliance with the License.
 ! You may obtain a copy of the License at
 !
 !     http://www.apache.org/licenses/LICENSE-2.0
 !
 ! Unless required by applicable law or agreed to in writing, software
 ! distributed under the License is distributed on an "AS IS" BASIS,
 ! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 ! See the License for the specific language governing permissions and
 ! limitations under the License. 
 -->

<h2 id="statement-types">Statement types<a class="headerlink" href="#statement-types" title="Permanent link">&para;</a></h2>
<p>Statements are a core feature of rdbc API. They represent SQL pieces that are sent
to a database for execution along with arguments, if any. There are two types
of statements in rdbc: template statements and executable statements. Template
statements can't be executed right away. To execute them you first need to bind argument
for every parameter they declare. When filled with arguments, template statements
create executable statements. Statements in rdbc are a representation of database 
engine's <a href="https://en.wikipedia.org/wiki/Prepared_statement">prepared statements</a>.</p>
<h2 id="syntax">Syntax<a class="headerlink" href="#syntax" title="Permanent link">&para;</a></h2>
<p>There isn't much of a syntax to describe. The only thing in a statement syntax
that rdbc adds to SQL is how parameters are defined. There are two kinds of
parameters: named and positional.</p>
<h3 id="named-parameters">Named parameters<a class="headerlink" href="#named-parameters" title="Permanent link">&para;</a></h3>
<p>Named parameters:</p>
<ul>
<li>are alphanumeric identifiers,</li>
<li>can be defined inside a query by prepending parameter identifier with a colon,</li>
<li>can be placed only where database engine expects parameters as defined
     by a database engine's prepared statement syntax,</li>
<li>are ignored inside varchar literals, column aliases, comments, etc.,</li>
<li>can be referenced by their name or by index (position).</li>
</ul>
<p>In the following statement just one parameter is declared: <code>login</code>:</p>
<div class="codehilite"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="p">:</span><span class="n">login</span>
</pre></div>


<p>A parameter can be used in multiple places. Statement below defines a single
parameter: <code>name</code>, but this parameter is used in two places:</p>
<div class="codehilite"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">first_name</span> <span class="o">=</span> <span class="p">:</span><span class="n">name</span> <span class="k">or</span> <span class="n">middle_name</span> <span class="o">=</span> <span class="p">:</span><span class="n">name</span> 
</pre></div>


<p>The statement below doesn't declare any parameters. "fname" is inside a varchar
literal and "mname" is part of a comment.</p>
<div class="codehilite"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">first_name</span> <span class="o">=</span> <span class="s1">&#39;:fname&#39;</span> <span class="c1">-- or middle_name = :mname</span>
</pre></div>


<h3 id="positional-parameters">Positional parameters<a class="headerlink" href="#positional-parameters" title="Permanent link">&para;</a></h3>
<p>Positional parameters:</p>
<ul>
<li>can be defined inside a query by placing a question mark: <code>?</code>,</li>
<li>can be placed only where database engine expects parameters as defined
     by a database engine's prepared statement syntax,</li>
<li>are ignored inside varchar literals, column aliases, comments, etc.,</li>
<li>can be referenced only by their index (position).</li>
</ul>
<p>The following example statement uses two positional parameters:</p>
<div class="codehilite"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">first_name</span> <span class="o">=</span> <span class="o">?</span> <span class="k">or</span> <span class="n">middle_name</span> <span class="o">=</span> <span class="o">?</span> 
</pre></div>


<p>The statement below doesn't declare any parameters. The first question mark is 
inside a varchar literal and the second is part of a comment.</p>
<div class="codehilite"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">first_name</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span> <span class="c1">-- or middle_name = ?</span>
</pre></div>


<h2 id="creating-statements">Creating statements<a class="headerlink" href="#creating-statements" title="Permanent link">&para;</a></h2>
<h3 id="bare-strings">Bare strings<a class="headerlink" href="#bare-strings" title="Permanent link">&para;</a></h3>
<p>Statement can be created using a bare string and then in a separate step be
filled with arguments for execution. There is a 
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/Connection.html#statement(sql:String):io.rdbc.sapi.Statement"><code>statement</code></a>
method defined in <code>Connection</code> trait that accepts a string, and returns a
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/Statement.html"><code>Statement</code></a>
instance bound to the connection:</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">stmt</span><span class="k">:</span> <span class="kt">Statement</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span>
 <span class="s">&quot;select * from users &quot;</span> <span class="o">+</span>
 <span class="s">&quot;where (first_name = :name or last_name = :name) and age = :age&quot;</span>
<span class="o">)</span>
</pre></div>


<p>Once you have a <code>Statement</code> object, you can bind values to its parameters:</p>
<ul>
<li>
<p><strong>by name</strong></p>
<p>To bind values to parameters by name, use <code>Statement</code>'s <code>bind</code> method that
accepts a sequence of <code>(String, Any)</code> tuples, one for each parameter. Above
statement's parameters could be bound to values like this:
<code class="codehilite"><span class="n">stmt</span><span class="o">.</span><span class="n">bind</span><span class="o">(</span><span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Casey&quot;</span><span class="o">,</span> <span class="s">&quot;age&quot;</span> <span class="o">-&gt;</span> <span class="mi">30</span><span class="o">)</span></code>.</p>
<p>If you don't provide all parameter values when binding, a
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/api/exceptions/MissingParamValException.html"><code>MissingParamValException</code></a>
will be thrown. If you provide value for a parameter that wasn't declared by
the query,
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/api/exceptions/NoSuchParamException.html"><code>NoSuchParamException</code></a>
will be thrown.</p>
<p>Binding by name is available only if name parameters were used.</p>
</li>
<li>
<p><strong>by index</strong></p>
<p>There is a possibility to bind values to parameters by index - i.e. just
provide a list of values and these values will be matched to every parameter
occurrence. Arguments can be bound to the above query like this:
<code class="codehilite"><span class="n">stmt</span><span class="o">.</span><span class="n">bind</span><span class="o">(</span><span class="s">&quot;Casey&quot;</span><span class="o">,</span> <span class="s">&quot;Casey&quot;</span><span class="o">,</span> <span class="mi">30</span><span class="o">)</span></code>.</p>
<p>If you provide too many parameters
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/api/exceptions/TooManyParamsException.html"><code>TooManyParamsException</code></a>
will be thrown.
If you provide too few parameters
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/api/exceptions/MissingParamValException.html"><code>MissingParamValException</code></a>
will be thrown.</p>
<p>This method of binding is the only one available if you used positional parameters.</p>
</li>
</ul>
<p>If your statement doesn't declare any parameters, use <code>bind</code> method without
passing any arguments to it.</p>
<h3 id="string-interpolator">String interpolator<a class="headerlink" href="#string-interpolator" title="Permanent link">&para;</a></h3>
<p>Creating statements using simple strings and binding values to parameters in
a separate step is flexible but this flexibility is not really needed in most
cases. A preferred way of creating statements is by using
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/SqlInterpolatorTrait$Sql.html#sql(args:Any*):io.rdbc.sapi.SqlWithParams"><code>sql</code></a>
<a href="http://docs.scala-lang.org/overviews/core/string-interpolation.html">string interpolator</a>.</p>
<p>You can get <code>sql</code> interpolator into scope either by importing everything from
<code>io.rdbc.sapi</code> package by <code class="codehilite"><span class="k">import</span> <span class="nn">io.rdbc.sapi._</span></code> statement or selectively by
<code class="codehilite"><span class="k">import</span> <span class="nn">io.rdbc.sapi.SqlInterpolator._</span></code> statement.</p>
<p>Once you have it in scope, you can use it to declare parameters and bind values
to them in one step, like this:</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">conn</span><span class="k">:</span> <span class="kt">Connection</span> <span class="o">=</span> <span class="o">???</span>

<span class="k">def</span> <span class="n">findUsersStmt</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">ExecutableStatement</span> <span class="o">=</span> <span class="o">{</span>
   <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;select * from users where name = $name&quot;</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>


<p>As you can see, when <code>sql</code> interpolator is used <code>Connection</code>'s <code>statement</code> method
produces <code>ExecutableStatement</code>, so the statement already has values
bound to its parameters. The above example is equivalent to the following, somewhat
less concise snippet:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">findUsersStmt</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">ExecutableStatement</span> <span class="o">=</span> <span class="o">{</span>   
    <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="s">&quot;select * from users where name = ?&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="n">bindByIdx</span><span class="o">(</span><span class="n">name</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>


<div class="admonition tip">
<p class="admonition-title">SQL injection safety</p>
<p>The important thing to understand is that when using <code>sql</code> interpolator you're still
safe from SQL injection vulnerability. Even though it may look like
that, parameter values are <strong>not</strong> passed to the database as literals
concatenated with the rest of the SQL.</p>
</div>
<p>SQL parts created by <code>sql</code> interpolator can be concatenated in the same way you
would concatenate plain strings:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">findUsersStmt</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">age</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">ExecutableStatement</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span>
   <span class="n">sql</span><span class="s">&quot;select * from users &quot;</span> <span class="o">+</span>
   <span class="n">sql</span><span class="s">&quot;where (first_name = $name or last_name = $name) and age = $age&quot;</span>
  <span class="o">)</span>
<span class="o">}</span>
</pre></div>


<h4 id="dynamic-sql">Dynamic SQL<a class="headerlink" href="#dynamic-sql" title="Permanent link">&para;</a></h4>
<p>Sometimes, most notably in tests or some one-time use scripts, it may be useful
to create SQL dynamically, like this:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">stmt</span><span class="o">(</span><span class="n">table</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">FutureExecutableStatement</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="s">s&quot;select * from </span><span class="si">$table</span><span class="s"> where name = :name&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="n">bind</span><span class="o">(</span><span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="n">name</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>


<p>If you want to create SQL dynamically and still benefit from <code>sql</code> interpolator
features, use <code>#$</code> prefix for dynamic parts, like this:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">sql</span><span class="o">(</span><span class="n">table</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">ExecutableStatement</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;select * from #$table where name = $name&quot;</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>


<p>In the above example, only <code>$name</code> is a statement parameter, <code>#$table</code> will be
simply replaced by <code>table</code> method parameter value.</p>
<h3 id="options">Options<a class="headerlink" href="#options" title="Permanent link">&para;</a></h3>
<p>When creating a statement you can provide options that can tweak statement's
behavior. To pass options, use <code>Connection</code>'s <code>statement</code> methods that accept
second argument of
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/StatementOptions$.html"><code>StatementOptions</code></a> type.</p>
<p>The list below contains currently supported options:</p>
<hr />
<ul>
<li>
<p><strong>Option:</strong> <code>generatedKeyCols</code></p>
<p>Controls statement behavior regarding returning keys generated by the
 database when issuing update or insert statements.</p>
<p><strong>Possible values</strong>:</p>
<ul>
<li><code>KeyColumns.All</code> &mdash; all columns with generated keys will be returned</li>
<li><code>KeyColumns.None</code> &mdash; no columns with generated keys will be returned</li>
<li><code>KeyColumns.named(cols: String*)</code> &mdash; only columns listed by name will be returned</li>
</ul>
<p><strong>Default value</strong>: <code>KeyColumns.None</code></p>
</li>
</ul>
<hr />
<p><code>StatementOptions</code> is a case class and in its companion object there is <code>Default</code>
instance of it with the default option values. You can use this instance to
tweak only some of the options using built-in <code>copy</code> method:</p>
<div class="codehilite"><pre><span></span><span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span>
  <span class="n">sql</span><span class="s">&quot;insert into users(name) values ($name)&quot;</span><span class="o">,</span>
  <span class="nc">Default</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">option1</span> <span class="k">=</span> <span class="n">value1</span><span class="o">,</span> <span class="n">option2</span> <span class="k">=</span> <span class="n">value2</span><span class="o">)</span>
<span class="o">)</span>
</pre></div>


<h2 id="executing-statements">Executing statements<a class="headerlink" href="#executing-statements" title="Permanent link">&para;</a></h2>
<p>Once you have an <code>ExecutableStatement</code> instance, you can execute it in a couple
of different ways. The method of execution controls in what shape you get the
results from the database. Paragraphs below describe methods of executing statements.</p>
<h3 id="executing-for-a-result-set">Executing for a result set<a class="headerlink" href="#executing-for-a-result-set" title="Permanent link">&para;</a></h3>
<p>Arguably the simplest method of execution that returns results is to execute
statement for a result set. To do this, use <code>ExecutableStatement</code>'s
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/ExecutableStatement.html#executeForSet()(implicittimeout:io.rdbc.sapi.Timeout):scala.concurrent.Future[io.rdbc.sapi.ResultSet]"><code>executeForSet</code></a>
method that returns <code>Future</code> of
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/ResultSet.html"><code>ResultSet</code></a>.</p>
<p><code>ResultSet</code> gives you access to the rows as well as to the metadata like warnings
issued by the DB engine, columns metadata and count of rows affected by the statement.
It also implements <code>Traversable</code> trait providing a convenience method of traversing
through the rows.</p>
<p>Executing for set is simple, but be aware that for bigger sets you may encounter
<code>OutOfMemoryError</code>s. All results are stored in memory, there is no paging of any
kind. If you want to avoid this sort of problems, consider
<a href="./#streaming-results">streaming</a> the results.</p>
<p>For the documentation on how to work with the resulting rows see
<a href="../rows/">Result Rows</a> chapter.</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">selectUserAge</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">ResultSet</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;select age from users where name = $name&quot;</span><span class="o">).</span><span class="n">executeForSet</span><span class="o">()</span>
<span class="o">}</span>
</pre></div>


<h3 id="streaming-results">Streaming results<a class="headerlink" href="#streaming-results" title="Permanent link">&para;</a></h3>
<p>To stream results from the database, use <code>ExecutableStatement</code>'s
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/ExecutableStatement.html#stream()(implicittimeout:io.rdbc.sapi.Timeout):io.rdbc.sapi.RowPublisher"><code>stream</code></a>
method. This method returns
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/RowPublisher.html"><code>RowPublisher</code></a>
instance which implements reactive stream's
<a href="http://www.reactive-streams.org/reactive-streams-1.0.1-javadoc/"><code>Publisher</code></a>
interface. <code>stream</code> method never throws exceptions &mdash; failures are reported by
the returned publisher.</p>
<p>Items published are rows represented by <code>Row</code> trait. For the documentation on how
to work with the resulting rows see <a href="../rows/">Result Rows</a> chapter.</p>
<p>Here are a couple of things to know when working with streams:</p>
<ul>
<li>statement execution is deferred until publisher is subscribed to,</li>
<li>a publisher can be subscribed to only once,</li>
<li>after <code>stream</code> method is invoked, connection is considered busy and can be used
     for other queries only after the stream completes or is cancelled,</li>
<li>cancel is an asynchronous operation and Reactive Streams specification doesn't
     provide a way of notifying a client that cancel operation completed. If clients
     want to use the connection after stream cancellation, they must watch for
     publisher's <code>done</code> <code>Future</code> completion before requesting any
     subsequent operations.</li>
</ul>
<p><code>RowPublisher</code> instance, through its members, gives access to number
of affected rows, warnings returned by the database and row metadata.</p>
<p>Processing streams is out of scope of this manual, for details please refer to
documentation of Reactive Streams compatible libraries that are built to
facilitate this, like
<a href="http://doc.akka.io/docs/akka/current/scala/stream/index.html">Akka stream</a> or
<a href="https://monix.io/">Monix</a>.</p>
<p>Examples (which release the connection on stream termination):</p>
<div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">akka.stream.scaladsl.</span><span class="o">{</span><span class="nc">Source</span><span class="o">,</span> <span class="nc">Sink</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">akka.NotUsed</span>

<span class="k">val</span> <span class="n">source</span><span class="k">:</span> <span class="kt">Source</span><span class="o">[</span><span class="kt">Row</span>, <span class="kt">NotUsed</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="nc">Source</span><span class="o">.</span><span class="n">fromPublisher</span><span class="o">(</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;select name from users&quot;</span><span class="o">).</span><span class="n">stream</span><span class="o">()</span>
  <span class="o">).</span><span class="n">alsoTo</span><span class="o">(</span><span class="nc">Sink</span><span class="o">.</span><span class="n">onComplete</span><span class="o">(</span><span class="k">_</span> <span class="k">=&gt;</span> <span class="n">conn</span><span class="o">.</span><span class="n">release</span><span class="o">()))</span>
<span class="o">}</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">monix.reactive.Observable</span>
<span class="k">import</span> <span class="nn">monix.eval.Task</span>

<span class="k">val</span> <span class="n">obs</span><span class="k">:</span> <span class="kt">Observable</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="nc">Observable</span><span class="o">.</span><span class="n">fromReactivePublisher</span><span class="o">(</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;select name from users&quot;</span><span class="o">).</span><span class="n">stream</span><span class="o">()</span>
  <span class="o">).</span><span class="n">doOnTerminateEval</span><span class="o">(</span><span class="k">_</span> <span class="k">=&gt;</span> <span class="nc">Task</span><span class="o">.</span><span class="n">fromFuture</span><span class="o">(</span><span class="n">conn</span><span class="o">.</span><span class="n">release</span><span class="o">()))</span>
<span class="o">}</span>
</pre></div>


<h3 id="executing-ignoring-results">Executing ignoring results<a class="headerlink" href="#executing-ignoring-results" title="Permanent link">&para;</a></h3>
<p>In many cases clients are not interested in any result of statement execution
other than simple "success" or "failure" information. This is often the case
for <code>insert</code>, <code>update</code> and <code>delete</code> commands. This use case is covered by
<code>ExecutableStatement</code>'s <code>execute</code> method which returns <code>Future</code> of <code>Unit</code>.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">insertUser</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;insert into users(name) values ($name)&quot;</span><span class="o">).</span><span class="n">execute</span><span class="o">()</span>
<span class="o">}</span>
</pre></div>


<h3 id="executing-for-a-single-row-and-for-a-value">Executing for a single row and for a value<a class="headerlink" href="#executing-for-a-single-row-and-for-a-value" title="Permanent link">&para;</a></h3>
<p>It is a common use case to expect just a single row to be returned by a query.
For instance, when querying by a primary key. This can be easily achieved by
using <code>ExecutableStatement</code>'s
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/ExecutableStatement.html#executeForFirstRow()(implicittimeout:io.rdbc.sapi.Timeout):scala.concurrent.Future[Option[io.rdbc.sapi.Row]]"><code>executeForFirstRow</code></a>
method which returns a <code>Future</code> of <code>Option[Row]</code>. Returned <code>Option</code> is <code>None</code>
in case when query doesn't return any results, otherwise, the first row is
returned as a <code>Some</code>.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">findUser</span><span class="o">(</span><span class="n">login</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">Row</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;select * from users where login = $login&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="n">executeForFirstRow</span><span class="o">()</span>
<span class="o">}</span>
</pre></div>


<p>Sometimes, not even a single row is needed by a client, only a single column
value, like user's name when searching by login.
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/ExecutableStatement.html#executeForValue[A](valExtractor:io.rdbc.sapi.Row=&gt;A)(implicittimeout:io.rdbc.sapi.Timeout):scala.concurrent.Future[Option[A]]"><code>executeForValue</code></a>
method comes in handy in these kind of situations. The method accepts  a function
that is supposed to extract this single value from a returned row, if any.</p>
<p>See the example below:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">findUsersName</span><span class="o">(</span><span class="n">login</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;select name from users where login = $login&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="n">executeForValue</span><span class="o">(</span><span class="n">r</span> <span class="k">=&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">str</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">))</span>
<span class="o">}</span>
</pre></div>


<p>For the documentation on how to work with the resulting rows see
<a href="../rows">Result Rows</a> chapter.</p>
<h3 id="executing-for-rows-affected">Executing for rows affected<a class="headerlink" href="#executing-for-rows-affected" title="Permanent link">&para;</a></h3>
<p>When executing insert, update or delete statements it may be good to know
how many rows were affected by the execution. A number of affected rows can be
obtained when executing for set or by streaming but if it's the only information
that is needed use <code>ExecutableStatement</code>'s 
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/ExecutableStatement.html#executeForRowsAffected()(implicittimeout:io.rdbc.sapi.Timeout):scala.concurrent.Future[Long]"><code>executeForRowsAffected</code></a>
method which returns a <code>Future</code> of <code>Long</code>.</p>
<p>See the example below:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">updateNames</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">age</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Long</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="n">sql</span><span class="s">&quot;update users set name = $name where age = $age&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="n">executeForRowsAffected</span><span class="o">()</span>
<span class="o">}</span>
</pre></div>


<h3 id="executing-for-generated-key">Executing for generated key<a class="headerlink" href="#executing-for-generated-key" title="Permanent link">&para;</a></h3>
<p>If you rely on primary keys being generated by the database when inserting
new records you'll need just this one key as a result of the execution. If you
need to get multiple generated values then use <code>executeForStream</code>, <code>executeForSet</code>
or <code>executeForFirstRow</code> described above but for a single one, there is
<a href="https://javadoc.io/page/io.rdbc/rdbc-api-scala_2.12/0.0.82/io/rdbc/sapi/ExecutableStatement.html#executeForKey[K]()(implicitevidence$1:scala.reflect.ClassTag[K],implicittimeout:io.rdbc.sapi.Timeout):scala.concurrent.Future[K]"><code>executeForKey</code></a>
method. This method executes a statement and returns the first column of the first
returned row (in most cases the result is going to be a single row with a single
column anyway). The method is parametrized by a type of the key.</p>
<p>A method in the example below inserts a new user and returns a generated UUID key.</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">insertUser</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">age</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">UUID</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span>
        <span class="n">sql</span><span class="s">&quot;insert into users(name, age) values($name, $age)&quot;</span><span class="o">,</span>
        <span class="nc">StatementOptions</span><span class="o">.</span><span class="nc">ReturnGenKeys</span>
  <span class="o">).</span><span class="n">executeForKey</span><span class="o">[</span><span class="kt">UUID</span><span class="o">]()</span>
<span class="o">}</span>
</pre></div>


<h3 id="streaming-statement-arguments">Streaming statement arguments<a class="headerlink" href="#streaming-statement-arguments" title="Permanent link">&para;</a></h3>
<p>rdbc provides an efficient way to execute statement repeatedly with many
sets of arguments. <code>Statement</code> can subscribe to a stream of argument sets by
invoking <code>streamArgs</code> or <code>streamArgsByIdx</code> methods which accept Reactive Streams'
<code>Publisher</code>. rdbc driver will back pressure the stream as needed.</p>
<p>Streaming arguments can be used for statements that don't return any values.
Technically it is possible to stream arguments of SQL <code>select</code>s but there are no
means for the client to get the data back from the database.</p>
<h4 id="positional-and-named-parameters">Positional and named parameters<a class="headerlink" href="#positional-and-named-parameters" title="Permanent link">&para;</a></h4>
<p>Each stream element contains entire set of arguments that a given statement
expects. Clients have an alternative of using named and positional parameters:
<code>streamArgs</code> accepts a stream producing <code class="codehilite"><span class="nc">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Any</span><span class="o">]</span></code> elements
(named parameters) and <code>streamArgsByIdx</code> indexed sequences of arguments
(positional parameters).</p>
<h4 id="handling-failures">Handling failures<a class="headerlink" href="#handling-failures" title="Permanent link">&para;</a></h4>
<p>If any error occurs in the middle of stream processing, the process will be aborted
and <code>Future</code> returned by the streaming method will fail too.</p>
<h4 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h4>
<p>Creating <code>Publisher</code> instances is out of scope of this manual, for details please
refer to documentation of Reactive Streams compatible libraries that are built to
facilitate this, like
<a href="http://doc.akka.io/docs/akka/current/scala/stream/index.html">Akka stream</a> or
<a href="https://monix.io/">Monix</a>. Examples below use simple streams backed by in-memory
collections.</p>
<p>Streaming named arguments with Akka:</p>
<div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">io.rdbc.sapi._</span>
<span class="k">import</span> <span class="nn">akka.stream.scaladsl.Source</span>

<span class="k">val</span> <span class="n">res</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">withTransaction</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">data</span><span class="k">:</span> <span class="kt">Vector</span><span class="o">[</span><span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Any</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">(</span>
    <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Robin&quot;</span><span class="o">,</span> <span class="s">&quot;age&quot;</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="o">),</span>
    <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Alex&quot;</span><span class="o">,</span> <span class="s">&quot;age&quot;</span> <span class="o">-&gt;</span> <span class="mi">32</span><span class="o">),</span>
    <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Casey&quot;</span><span class="o">,</span> <span class="s">&quot;age&quot;</span> <span class="o">-&gt;</span> <span class="mi">12</span><span class="o">)</span>
  <span class="o">)</span>
  <span class="k">val</span> <span class="n">publisher</span> <span class="k">=</span> <span class="nc">Source</span><span class="o">(</span><span class="n">data</span><span class="o">).</span><span class="n">runWith</span><span class="o">(</span><span class="nc">Sink</span><span class="o">.</span><span class="n">asPublisher</span><span class="o">(</span><span class="n">fanout</span> <span class="k">=</span> <span class="kc">false</span><span class="o">))</span>
  <span class="k">val</span> <span class="n">stmt</span> <span class="k">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="s">&quot;insert into users(name, age) values (:name, :age)&quot;</span><span class="o">)</span>
  <span class="n">stmt</span><span class="o">.</span><span class="n">streamArgs</span><span class="o">(</span><span class="n">publisher</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>


<p>Streaming positional arguments with Akka:</p>
<div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">io.rdbc.sapi._</span>
<span class="k">import</span> <span class="nn">akka.stream.scaladsl.Source</span>

<span class="k">val</span> <span class="n">res</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">withTransaction</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">data</span><span class="k">:</span> <span class="kt">Vector</span><span class="o">[</span><span class="kt">Vector</span><span class="o">[</span><span class="kt">Any</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">(</span>
    <span class="nc">Vector</span><span class="o">(</span><span class="s">&quot;Robin&quot;</span><span class="o">,</span> <span class="mi">10</span><span class="o">),</span>
    <span class="nc">Vector</span><span class="o">(</span><span class="s">&quot;Alex&quot;</span><span class="o">,</span> <span class="mi">32</span><span class="o">),</span>
    <span class="nc">Vector</span><span class="o">(</span><span class="s">&quot;Casey&quot;</span><span class="o">,</span> <span class="mi">12</span><span class="o">)</span>
  <span class="o">)</span>
  <span class="k">val</span> <span class="n">publisher</span> <span class="k">=</span> <span class="nc">Source</span><span class="o">(</span><span class="n">data</span><span class="o">).</span><span class="n">runWith</span><span class="o">(</span><span class="nc">Sink</span><span class="o">.</span><span class="n">asPublisher</span><span class="o">(</span><span class="n">fanout</span> <span class="k">=</span> <span class="kc">false</span><span class="o">))</span>
  <span class="k">val</span> <span class="n">stmt</span> <span class="k">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">statement</span><span class="o">(</span><span class="s">&quot;insert into users(name, age) values (?, ?)&quot;</span><span class="o">)</span>
  <span class="n">stmt</span><span class="o">.</span><span class="n">streamArgsByIdx</span><span class="o">(</span><span class="n">publisher</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../connection/" title="Working with a connection" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Working with a connection
              </span>
            </div>
          </a>
        
        
          <a href="../types/" title="Data types" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Data types
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 rdbc contributors
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/rdbc-io" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/rdbc_io" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
        <script src="../../javascripts/extra.js"></script>
      
    
    
      
    
  </body>
</html>
